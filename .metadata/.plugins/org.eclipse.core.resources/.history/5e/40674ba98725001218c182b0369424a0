package com.example.cameratest.processors;

import com.example.cameratest.events.TestFrameProcessedEvent;
import com.example.cameratest.listeners.TestFrameProcessedListener;

import android.hardware.*;
import android.hardware.Camera.*;

public class TestFrameProcessor implements PreviewCallback {
	private long timeStamp = 0;
	private TestFrameProcessedListener mListener;
	private Camera mCamera;
	
	public TestFrameProcessor(TestFrameProcessedListener listener, Camera camera) {
		this.mListener = listener;
		this.mCamera = camera;
	}
	
	public void onPreviewFrame(byte[] data, Camera camera) {
		long newTimeStamp = System.currentTimeMillis();
		mCamera.addCallbackBuffer(data);
		mListener.onFrameProcessed(new TestFrameProcessedEvent(newTimeStamp - timeStamp));
		timeStamp = newTimeStamp;
	}
}
